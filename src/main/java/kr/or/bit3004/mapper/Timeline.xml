<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.or.bit3004.dao.TimelineDao">
	<select id="getTimeline" resultType="kr.or.bit3004.timeline.Timeline">
		select `timeline_no`, `COLUMN_NAME`, `COLUMN_NO`, `old_history`, `history`, `DML_KIND`, `history_time`, `team_no`, t.`id`, `nickname`, `image`, `table_name`, `all_board_no`
		  from `timeline` t
		  join `user` u
		    on t.id = u.id
		 where `team_no` = #{teamNo}
		 order by `timeline_no` desc
	</select>
	
	<select id="countTodaysNewKanbanCards" resultType="int">
		SELECT COUNT(*)
		FROM KANBAN_CARD AS KC
			JOIN KANBAN LIST AS KL
				ON KC.KANBAN_LIST_NO = KL.KANBAN_LIST_NO
			JOIN ALL_BAORD_LIST AS AL
				ON KL.ALL_BOARD_LIST_NO = AL.ALL_BOARD_LIST_NO
		WHERE WRITE_DATE >= CURDATE()
			AND TEAM_NO = #{teamNo}	
	</select>
	
	<select id="countTodaysNewBoards" resultType="int">
		SELECT COUNT(*)
		FROM BOARD_LIST AS BL
			JOIN ALL_BOARD_LIST AS AL
				ON BL.ALL_BOARD_LIST_NO = AL.ALL_BOARD_LIST_NO
		WHERE WRITE_DATE >= CURDATE()
			AND TEAM_NO = #{teamNo}	
	</select>
	
	
</mapper>
